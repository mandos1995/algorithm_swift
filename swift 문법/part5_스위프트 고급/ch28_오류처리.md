# 28. 오류처리

대부분의 프로그래밍 언어는 프로그램에서 발생하는 오류에 대비하기 위해 오류를 처리하는 기능을 제공한다. 스위프트도 오류를 적절히 처리할 수 있는 기능을 제공한다. 스위프트가 제공하는 오류처리 기능에 대해 알아보자.

## 28.1 오류처리란

**오류처리** 는 프로그램이 오류를 일으켰을 때 이것을 감지하고 회복시키는 일련의 과정이다.

프로그램에서 모든 기능이 우리가 원하는대로 100% 정확히 동작한다는 보장은 없다. 특히나 전달받아야 하는 값이 까다롭거나 데이터를 가공하는 데 소비하는 자원이 많을 경우 오류가 발생할 확률이 높아진다. 이런 가능성이 있는 기능을 구현할 때는 오류가 발생할 수 있음을 항상 고려해야 한다.

예를 들어 디스크의 파일을 읽어오는 기능을 생각해보자. 파일이 존재하지 않을 수도 있으며, 읽기 권한이 없을 수도 있고, 잘못된 파일일 가능성도 있다. 이렇게 파일을 읽어오는 간단한 기능에서도 오류가 발생할 수 있는 가능성이 여럿 존재한다. 오류처리 기능을 통해 이런 상황들을 구별하여 프로그램 자체적으로 오류를 해결할 수 있고, 사용자와 상호작용을 통해 오류를 어떤 방향으로 풀어나갈지 제어할 수도 있다.

다만 주의할 점은 스위프트의 오류처리 기능을 통해 시스템(예를 들어 운영체제 등 우리가 작성하는 응용프로그램 외부)에서 발생한 오류를 처리할 수 있는 것이 아님을 명시해야 한다.

## 28.2 오류의 표현

스위프트에서 오류는 Error라는 프로토콜을 준수하는 타입의 값을 통해 표현된다. Error 프로토콜은 사실상 요구사항이 없는 빈 프로토콜일 뿐이지만, 오류를 표현하기 위한 타입(주로 열거형)은 이 프로토콜을 채택한다.

스위프트의 열거형은 오류의 종류를 나타내기에 아주 적합한 기능이다. 연관 값을 통해 오류에 관한 부가 정보를 제공할 수도 있다. 다음 코드는 프로그램 내에서 자판기를 작동시키려고 할 때 발생하는 오류의 종류를 열거형으로 표현한 것이다.

```swift
enum VendingMachineError: Error {
    case invalidSelection
    case insufficientFunds(coinsNeeded: Int)
    case outOfStock
}
```

VendingMachineError 열거형을 살펴보면 Error 프로토콜을 채택함으로써 오류처리를 위한 타입임을 알 수 있다. 그리고 이 코드에서 오류의 종류는 invalidSelection(유효하지 않은 선택), insufficientFunds(coinsNeeded: Int) (자금 부족 - 필요한 동전 개수), outOfStock(품절) 등 세 가지가 있다. 이처럼 열거형을 통해 오류의 종류를 표현하는 것이 가장 일반적이며 편리한 방법이다.

이렇게 오류의 종류를 미리 예상한 다음, 오류 때문에 다음에 행할 동작이 정상적으로 진행되지 않을 때라면 **오류를 던져** 주면 된다. 오류를 던져줄 때는 throw 구문을 사용한다. 만약 자금이 부족하고 동전이 5개 더 필요한 상황이라면 throw VendingMachineError.insufficientFunds(coinsNeeded: 5) 라고 오류를 던져줄 수 있다.

이제 던져진 오류를 포착하고 처리하는 방법을 알아보자.
